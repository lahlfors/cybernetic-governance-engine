apiVersion: gateway.networking.k8s.io/v1beta1
kind: HTTPRoute
metadata:
  name: llm-route
  namespace: default
spec:
  parentRefs:
  - name: llm-gateway
  rules:
  # Routing Rule 1: Reasoning Model (High Complexity)
  - matches:
    - path:
        type: PathPrefix
        value: /v1/chat/completions
      headers:
      - type: Exact
        name: "x-model-id"
        value: "deepseek-ai/DeepSeek-R1-Distill-Qwen-32B"
    backendRefs:
    - name: vllm-reasoning
      namespace: governance-stack
      kind: Service
      port: 8000

  # Routing Rule 2: Governance Model (Low Latency / High Priority)
  - matches:
    - path:
        type: PathPrefix
        value: /v1/chat/completions
      headers:
      - type: Exact
        name: "x-model-id"
        value: "Qwen/Qwen2.5-7B-Instruct"
    backendRefs:
    - name: vllm-inference
      namespace: governance-stack
      kind: Service
      port: 8000
