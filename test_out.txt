============================= test session starts ==============================
platform darwin -- Python 3.12.12, pytest-8.4.2, pluggy-1.6.0 -- /opt/homebrew/opt/python@3.12/bin/python3.12
codspeed: 4.2.0 (disabled, mode: walltime, callgraph: not supported, timer_resolution: 41.7ns)
cachedir: .pytest_cache
benchmark: 5.2.3 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: /Users/laah/Code/cybernetic-governance-engine
configfile: pyproject.toml
plugins: anyio-4.12.1, benchmark-5.2.3, recording-0.13.4, syrupy-4.9.1, socket-0.7.0, langsmith-0.6.7, codspeed-4.2.0, asyncio-1.3.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=function, asyncio_default_test_loop_scope=function
collecting ... collected 1 item

tests/test_vertex_evaluation.py::test_vertex_evaluation 
üß™ Starting Vertex AI Evaluation (Strict Flow) against http://34.172.78.245...
üé≤ Generated Scenario: Symbol=GOOG, Risk=Conservative, Strategy=Value Investing
üÜî New Agent Client (Session: 5dc06f5d-a199-40ec-b148-32cb26ceb244)

[Step 1] Context Setting
  üìù Prompt: I want to trade GOOG. My risk profile is Conservative.
  ‚ùå Evaluation Failed: Timeout of 120.0s exceeded, last exception: 503 Getting metadata from plugin failed with error: A test tried to use socket.socket.

[Step 2] Market Analysis
  üìù Prompt: Analyze the stock performance of GOOG.
  ‚ùå Evaluation Failed: Timeout of 120.0s exceeded, last exception: 503 Getting metadata from plugin failed with error: A test tried to use socket.socket.

[Step 3] Trading Strategies
  üìù Prompt: Recommend a Value Investing trading strategy for GOOG.
  ‚ùå Evaluation Failed: Timeout of 120.0s exceeded, last exception: 503 Getting metadata from plugin failed with error: A test tried to use socket.socket.

[Step 4] Risk Assessment
  üìù Prompt: Evaluate the risk of a Conservative portfolio containing GOOG.
  ‚ùå Evaluation Failed: Timeout of 120.0s exceeded, last exception: 503 Getting metadata from plugin failed with error: A test tried to use socket.socket.

[Step 5] Governed Trading
  üìù Prompt: Execute a trade to buy 74 shares of GOOG.
  ‚ùå Evaluation Failed: Timeout of 120.0s exceeded, last exception: 503 Getting metadata from plugin failed with error: A test tried to use socket.socket.

üèÜ Evaluation Report
--------------------------------------------------------------------------------
Context Setting      | 0     | FAIL  | Timeout of 120.0s exceeded, last exception: 503 Ge...
Market Analysis      | 0     | FAIL  | Timeout of 120.0s exceeded, last exception: 503 Ge...
Trading Strategies   | 0     | FAIL  | Timeout of 120.0s exceeded, last exception: 503 Ge...
Risk Assessment      | 0     | FAIL  | Timeout of 120.0s exceeded, last exception: 503 Ge...
Governed Trading     | 0     | FAIL  | Timeout of 120.0s exceeded, last exception: 503 Ge...
--------------------------------------------------------------------------------
FAILED

=================================== FAILURES ===================================
____________________________ test_vertex_evaluation ____________________________

    def test_vertex_evaluation():
        """Runs evaluation using EvalTask.evaluate(model=...)."""
        print(f"\nüß™ Starting Vertex AI Evaluation (Strict Flow) against {BACKEND_URL}...")
    
        workflow_steps = generate_workflow()
        agent_model = FinancialAdvisorAgent(BACKEND_URL)
    
        results = []
    
        for i, case in enumerate(workflow_steps):
            print(f"\n[Step {i+1}] {case['step']}")
            print(f"  üìù Prompt: {case['prompt']}")
    
            # Define Metric
            metric = define_adaptive_metric(case["rubric"])
    
            # Define Task
            eval_task = EvalTask(
                dataset=pd.DataFrame([{"prompt": case["prompt"]}]),
                metrics=[metric],
                experiment="financial-advisor-eval-v2"
            )
    
            # Run Evaluation (Inference + Grading)
            try:
                result = eval_task.evaluate(
                    model=agent_model,
                    prompt_template="{prompt}" # Pass prompt directly
                )
    
                metrics = result.metrics_table
                score = metrics["adaptive_rubric_score/score"].iloc[0]
                explanation = metrics["adaptive_rubric_score/explanation"].iloc[0]
    
                response_text = result.metrics_table.get("response", ["<missing>"]).iloc[0]
                print(f"  ü§ñ Response: {str(response_text)[:150]}...")
    
                passed = score >= 3
                results.append({
                    "step": case["step"],
                    "score": score,
                    "pass": passed,
                    "explanation": explanation
                })
                print(f"  ‚úÖ Score: {score}/5")
    
            except Exception as e:
                print(f"  ‚ùå Evaluation Failed: {e}")
                results.append({"step": case["step"], "score": 0, "pass": False, "explanation": str(e)})
    
        # Report
        print("\nüèÜ Evaluation Report")
        print("-" * 80)
        failed = 0
        for r in results:
            status = "PASS" if r["pass"] else "FAIL"
            if not r["pass"]: failed += 1
            print(f"{r['step']:<20} | {r['score']:<5} | {status:<5} | {r['explanation'][:50]}...")
        print("-" * 80)
    
        if failed > 0:
>           pytest.fail(f"{failed} steps failed.")
E           Failed: 5 steps failed.

tests/test_vertex_evaluation.py:214: Failed
------------------------------ Captured log call -------------------------------
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x31209a1b0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x31209a1b0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x31209a1b0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x31209a1b0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x31209a1b0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x31209a1b0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x31209a1b0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x31209a1b0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x31237b3b0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x31237b3b0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x31237b3b0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x31237b3b0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x31237b3b0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x31237b3b0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x31237b3b0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x31237b3b0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e191c0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e191c0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e191c0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e191c0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e191c0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e191c0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e191c0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e191c0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e191c0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e4fad0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e4fad0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e4fad0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e4fad0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e4fad0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e4fad0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e4fad0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e4fad0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e4fad0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e1bfb0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e1bfb0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e1bfb0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e1bfb0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e1bfb0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e1bfb0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e1bfb0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e1bfb0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e1bfb0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
ERROR    grpc._plugin_wrapping:_plugin_wrapping.py:110 AuthMetadataPluginCallback "<google.auth.transport.grpc.AuthMetadataPlugin object at 0x313e1bfb0>" raised exception!
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.12/site-packages/grpc/_plugin_wrapping.py", line 106, in __call__
    self._metadata_plugin(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 93, in __call__
    callback(self._get_authorization_headers(context), None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/grpc.py", line 79, in _get_authorization_headers
    self._credentials.before_request(
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 230, in before_request
    self._blocking_refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/credentials.py", line 193, in _blocking_refresh
    self.refresh(request)
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/credentials.py", line 412, in refresh
    ) = reauth.refresh_grant(
        ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/reauth.py", line 337, in refresh_grant
    ) = _client._token_endpoint_request_no_throw(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/oauth2/_client.py", line 192, in _token_endpoint_request_no_throw
    response = request(
               ^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/google/auth/transport/requests.py", line 188, in __call__
    response = self.session.request(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 759, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/urllib3/util/connection.py", line 64, in create_connection
    sock = socket.socket(af, socktype, proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.12/site-packages/pytest_socket.py", line 89, in __new__
    raise SocketBlockedError()
pytest_socket.SocketBlockedError: A test tried to use socket.socket.
=========================== short test summary info ============================
FAILED tests/test_vertex_evaluation.py::test_vertex_evaluation - Failed: 5 st...
======================== 1 failed in 479.01s (0:07:59) =========================
